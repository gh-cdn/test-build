/*!  The roject developed by chengpeiquan!  */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1513eee3"],{"2a42":function(e,t,n){},"5e53":function(e,t,n){"use strict";var a=n("f3f3"),r=n("c964"),i=(n("96cf"),n("d81d"),n("d0ff")),o=(n("d3b7"),n("159b"),function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return new Promise((function(a){setTimeout((function(){if(t){var n=document.querySelectorAll(e),r=Object(i["a"])(n),o=[];r.forEach((function(e,t){var n="";t<r.length-1&&(n=r[t+1].getAttribute("id")||"");var a=e.innerHTML;o.push({id:e.getAttribute("id")||"",nextPlotId:n,template:a})})),a(o)}else{var c=document.querySelector(e),s={id:c?c.getAttribute("id"):"",nextPlotId:"",template:c?c.innerHTML:""};a(s)}}),n)}))}),c=o,s=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c(".render-canvas-plot",!0);case 2:if(t=e.sent,Array.isArray(t)){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",t.map((function(e){return Object(a["a"])(Object(a["a"])({},e),{},{extraInfo:{autoPlayConfig:{isOpen:!1,animation:"",nextPlotId:"",sceneRange:"",timeout:0},quickDialogueConfigList:[]}})})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t["a"]=s},7495:function(e,t,n){"use strict";n.r(t);var a=n("c964"),r=(n("96cf"),n("4de4"),n("a9e3"),n("caad"),n("2532"),n("7a23")),i=n("6c02"),o=n("5502"),c=n("2abc"),s=n.n(c),u=n("2706"),l=n("be9c"),p=n("6256"),f=n("e160"),d=n("7782"),b=Object(r["defineComponent"])({expose:[],setup:function(e){var t=Object(i["d"])(),n=Object(o["b"])(),c=Object(r["computed"])((function(){return n.state})),b=Object(r["ref"])(0),m=Object(r["reactive"])([{isDisable:!1,text:"图片",list:u["b"].filter((function(e){return"picture"===e.elementInfo.category}))},{isDisable:!0,text:"视频",list:[]},{isDisable:!1,text:"剧情文本",list:u["b"].filter((function(e){return"text"===e.elementInfo.category}))},{isDisable:!0,text:"背景音乐",list:[]},{isDisable:!0,text:"效果音乐",list:[]},{isDisable:!0,text:"控件",list:[]},{isDisable:!0,text:"画面效果",list:[]}]),v=Object(r["computed"])((function(){return n.state.canvas.plotInfo.id})),g=Object(r["ref"])("请先选择剧情才能操作"),y=Object(r["ref"])(!1),x=Object(r["ref"])(0);x.value=t.params.id?Number(t.params.id):0;var h=function(){p["a"].warning(g.value)},O=function(e){var t=m[e].isDisable;t||(b.value=Number(e))},w=function(e){},j=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var a,r,i,o,c,u,l,d,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.target,y.value=!0,v.value){e.next=7;break}return h(),a.value="",y.value=!1,e.abrupt("return",!1);case 7:if(r=a.files[0]||{size:0,type:""},i=r.size,o=r.type,c=["image/png","image/jpeg","image/webp"],c.includes(o)){e.next=15;break}return p["a"].error("请选择jpg、png、webp格式的图片"),a.value="",y.value=!1,e.abrupt("return",!1);case 15:if(!(i>10485760)){e.next=20;break}return p["a"].error("图片大小不能超过10M"),a.value="",y.value=!1,e.abrupt("return",!1);case 20:return u=a.dataset.component||"",e.next=23,Object(f["a"])(r);case 23:if(l=e.sent,l){e.next=30;break}return e.next=27,s()(r);case 27:d=e.sent,b=d[0].base64,l=b;case 30:n.dispatch("canvas/receiveComponent",{componentTag:u,propValue:l}),a.value="",y.value=!1;case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){var t={};"v-text-options"===e&&(t["fontFamily"]=l["a"].fontFamilyList[0].type,t["fontSize"]=16),n.dispatch("canvas/receiveComponent",{componentTag:e,propValue:{style:t,optionList:[{image:"",text:"默认"},{image:"",text:"默认"}],autoPlayConfig:{isOpen:!1,timeout:10}}})},I=function(){n.dispatch("canvas/receiveComponent",{componentTag:"v-normal-dialogue",propValue:{content:"请输入对话框内容",style:{fontFamily:l["a"].fontFamilyList[0].type,fontSize:16}}})};return Object(i["c"])((function(){Object(d["a"])(x.value,c.value)})),{route:t,store:n,state:c,curElementTypeIndex:b,elementTypeList:m,curPlotId:v,notAllowTips:g,isUploading:y,editorId:x,showNotAllowTips:h,changeElementType:O,handleDragStart:w,getFileInfo:j,addOptions:D,addDialogue:I,reactive:r["reactive"],ref:r["ref"],computed:r["computed"],onBeforeRouteLeave:i["c"],useRoute:i["d"],useStore:o["b"],readFile:s.a,componentList:u["b"],fontPreset:l["a"],message:p["a"],ossUpload:f["a"],saveCanvasData:d["a"]}}});n("bddb");b.__scopeId="data-v-71575cea";t["default"]=b},7782:function(e,t,n){"use strict";var a=n("c964"),r=(n("96cf"),n("d81d"),n("7db0"),n("d3b7"),n("a9e3"),n("caad"),n("2532"),n("2ef0")),i=n("6256"),o=n("0480"),c=n("9996"),s=n("5e53"),u={editorId:0,state:{},canvasData:[]},l=function(){var e={workId:u.editorId,chapterList:[]},t=u.state.chapter.list;return e["chapterList"]=t.map((function(e){var t={chapterNo:e.id,chapterName:e.title,plotList:[]};return t["plotList"]=e.plotList.map((function(e){var t=e.treeChildList.map((function(e){return String(e.target.plotId)})),n=u.canvasData.find((function(t){return t.id===e.id}))||{};return{autoPlayConfig:JSON.stringify(e.autoPlayConfig),componentData:JSON.stringify(e.componentData),content:JSON.stringify(n),cover:e.cover,name:e.title,no:e.id,targets:JSON.stringify(t),treeChildList:JSON.stringify(e.treeChildList)}})),t})),new Promise((function(t){Object(c["a"])({method:"post",url:"/interact/drama",data:e}).then((function(e){var n=e.code,a=e.msg||"";0!==n&&t({status:!1,msg:a}),t({status:!0,msg:"进度保存成功"})})).catch((function(e){t({status:!1,msg:e})}))}))},p=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var a,c,p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t&&n){e.next=3;break}return i["a"].error("保存进度出错，请检查传入的编辑器参数"),e.abrupt("return",!1);case 3:return u.editorId=Number(t),u.state=n,e.next=7,Object(s["a"])();case 7:if(u.canvasData=e.sent,window.location.host.includes("localhost")){e.next=15;break}return e.next=11,l();case 11:a=e.sent,c=a.status,p=a.msg,c?i["a"].success(p):i["a"].error(p);case 15:try{f=Object(r["cloneDeep"])(n),o["a"].setItem("id_".concat(t),f)}catch(d){console.log(d)}case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t["a"]=p},bddb:function(e,t,n){"use strict";n("2a42")},be9c:function(e,t,n){"use strict";var a={fontFamilyList:[{type:"PingFangSC-Regular, PingFang SC, Microsoft YaHei, Helvetica Neue, Arial, HelveticaNeue, Helvetica, BBAlpha Sans, sans-serif",text:"默认"}],styleBtns:[{type:"b",text:"加粗"},{type:"i",text:"斜体"},{type:"u",text:"下划线"},{type:"left",text:"居左"},{type:"center",text:"居中"},{type:"right",text:"居右"}]};t["a"]=a}}]);